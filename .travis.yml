language: python

python: 
  - "3.8"
  - "3.6"
  - "nightly"
  - "pypy3"

jobs:
  include:
    - name: "Python 3.7.7 on macOS"
      os: osx
      osx_image: xcode11.2  # Python 3.7.4 running on macOS 10.14.4
      language: shell       # install Python through shell since 'language: python' is an error on Travis CI macOS
    - name: "Python 3.8.0 on Windows"
      os: windows           # Windows 10.0.17134 N/A Build 17134
      language: shell       # manually installing Python since 'language: python' is an error on Travis CI Windows
      before_install:
        - choco install python --version 3.8.0
        - python -m pip install --upgrade pip
      env: PATH=/c/Python38:/c/Python38/Scripts:$PATH
      after_install:
        - python -m coverage run -m pytest


install:
  - pip install -U pip
  - pip install tox-travis
#  - pip install -r requirements-dev.txt --> Handled by tox. Dependencies for pytest, code coverage, and formatting
#  - python setup.py install  --> Handled by tox. We use setup.py instead of the usual - pip install -e . (which tells Travis to install my package as a wheel)
#  - pip install -r requirements.txt --> this is covered by setup.py (which is handled by tox)

before_script:
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build

script:
  - tox
  
after_script:
  - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT
  
after_success:
  â€” coveralls
